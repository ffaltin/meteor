!function(t,i,e){"use strict";function o(){N=i.$body,D=t("html, body")}function a(){F&&d()}function n(t){this.on(A.click,t,g)}function r(t){s(),this.off(A.namespace)}function l(i,e){i instanceof t&&g.apply(S,[{data:t.extend(!0,{},{$object:i},R,e||{})}])}function g(e){if(!F){var o=e.data,a=o.$el,n=o.$object,r=a&&a[0].href?a[0].href||"":"",l=a&&a[0].hash?a[0].hash||"":"",g=r.toLowerCase().split(".").pop().split(/\#|\?/),d=g[0],h=a?a.data(P+"-type"):"",c="image"===h||t.inArray(d,o.extensions)>-1||"data:image"===r.substr(0,10),m=L(r),w="url"===h||!c&&!m&&"http"===r.substr(0,4)&&!l,H="element"===h||!c&&!m&&!w&&"#"===l.substr(0,1),f="undefined"!=typeof n;if(H&&(r=l),!(c||m||w||H||f))return;if(B.killEvent(e),F=t.extend({},{visible:!1,gallery:{active:!1},isMobile:i.isMobile||o.mobile,isTouch:i.support.touch,isAnimating:!0,oldContentHeight:0,oldContentWidth:0},o),F.margin*=2,c?F.type="image":m?F.type="video":F.type="element",c||m){var b=a.data(P+"-gallery");b&&(F.gallery.active=!0,F.gallery.id=b,F.gallery.$items=t("a[data-lightbox-gallery= "+F.gallery.id+"], a[rel= "+F.gallery.id+"]"),F.gallery.index=F.gallery.$items.index(F.$el),F.gallery.total=F.gallery.$items.length-1)}var W="";F.isMobile||(W+='<div class="'+[q.raw.overlay,F.customClass].join(" ")+'"></div>');var y=[q.raw.base,q.raw.loading,q.raw.animating,F.customClass];F.fixed&&y.push(q.raw.fixed),F.isMobile&&y.push(q.raw.mobile),F.isTouch&&y.push(q.raw.touch),w&&y.push(q.raw.iframed),(H||f)&&y.push(q.raw.inline),W+='<div class="'+y.join(" ")+'">',W+='<button type="button" class="'+q.raw.close+'">'+F.labels.close+"</button>",W+='<span class="'+q.raw.loading_icon+'"></span>',W+='<div class="'+q.raw.container+'">',W+='<div class="'+q.raw.content+'">',(c||m)&&(W+='<div class="'+q.raw.tools+'">',W+='<div class="'+q.raw.controls+'">',F.gallery.active&&(W+='<button type="button" class="'+[q.raw.control,q.raw.control_previous].join(" ")+'">'+F.labels.previous+"</button>",W+='<button type="button" class="'+[q.raw.control,q.raw.control_next].join(" ")+'">'+F.labels.next+"</button>"),F.isMobile&&F.isTouch&&(W+='<button type="button" class="'+[q.raw.caption_toggle].join(" ")+'">'+F.labels.captionClosed+"</button>"),W+="</div>",W+='<div class="'+q.raw.meta+'">',F.gallery.active&&(W+='<p class="'+q.raw.position+'"',F.gallery.total<1&&(W+=' style="display: none;"'),W+=">",W+='<span class="'+q.raw.position_current+'">'+(F.gallery.index+1)+"</span> ",W+=F.labels.count,W+=' <span class="'+q.raw.position_total+'">'+(F.gallery.total+1)+"</span>",W+="</p>"),W+='<div class="'+q.raw.caption+'">',W+=F.formatter.call(a,o),W+="</div></div>",W+="</div>"),W+="</div></div></div>",N.append(W),F.$overlay=t(q.overlay),F.$lightbox=t(q.base),F.$close=t(q.close),F.$container=t(q.container),F.$content=t(q.content),F.$tools=t(q.tools),F.$meta=t(q.meta),F.$position=t(q.position),F.$caption=t(q.caption),F.$controlBox=t(q.controls),F.$controls=t(q.control),F.isMobile?(F.paddingVertical=F.$close.outerHeight(),F.paddingHorizontal=0,F.mobilePaddingVertical=parseInt(F.$content.css("paddingTop"),10)+parseInt(F.$content.css("paddingBottom"),10),F.mobilePaddingHorizontal=parseInt(F.$content.css("paddingLeft"),10)+parseInt(F.$content.css("paddingRight"),10)):(F.paddingVertical=parseInt(F.$lightbox.css("paddingTop"),10)+parseInt(F.$lightbox.css("paddingBottom"),10),F.paddingHorizontal=parseInt(F.$lightbox.css("paddingLeft"),10)+parseInt(F.$lightbox.css("paddingRight"),10),F.mobilePaddingVertical=0,F.mobilePaddingHorizontal=0),F.contentHeight=F.$lightbox.outerHeight()-F.paddingVertical,F.contentWidth=F.$lightbox.outerWidth()-F.paddingHorizontal,F.controlHeight=F.$controls.outerHeight(),p(),F.gallery.active&&(F.$lightbox.addClass(E.has_controls),C()),K.on(A.keyDown,I),N.on(A.clickTouchStart,[q.overlay,q.close].join(", "),s),F.gallery.active&&F.$lightbox.on(A.clickTouchStart,q.control,x),F.isMobile&&F.isTouch&&F.$lightbox.on(A.clickTouchStart,q.caption_toggle,u),F.$lightbox.fsTransition({property:"opacity"},function(){c?v(r):m?$(r):w?_(r):H?M(r):f&&V(F.$object)}).addClass(q.raw.open),F.$overlay.addClass(q.raw.open)}}function d(t){"object"!=typeof t&&(F.targetHeight=arguments[0],F.targetWidth=arguments[1]),"element"===F.type?T(F.$content.find("> :first-child")):"image"===F.type?f():"video"===F.type&&W(),c()}function s(t){B.killEvent(t),F&&(F.$lightbox.fsTransition("destroy"),F.$container.fsTransition("destroy"),F.$lightbox.addClass(q.raw.animating).fsTransition({property:"opacity"},function(t){F.$lightbox.off(A.namespace),F.$container.off(A.namespace),K.off(A.namespace),N.off(A.namespace),F.$overlay.remove(),F.$lightbox.remove(),F=null,K.trigger(A.close)}),F.$lightbox.removeClass(q.raw.open),F.$overlay.removeClass(q.raw.open),F.isMobile&&D.removeClass(E.lock))}function h(){var t=m();F.isMobile?0:F.duration;F.isMobile||F.$controls.css({marginTop:(F.contentHeight-F.controlHeight-F.metaHeight)/2}),!F.visible&&F.isMobile&&F.gallery.active&&F.$content.fsTouch({axis:"x",swipe:!0}).on(A.swipe,z),F.$lightbox.fsTransition({property:F.contentHeight!==F.oldContentHeight?"height":"width"},function(){F.$container.fsTransition({property:"opacity"},function(){F.$lightbox.removeClass(q.raw.animating),F.isAnimating=!1}),F.$lightbox.removeClass(q.raw.loading),F.visible=!0,K.trigger(A.open),F.gallery.active&&y()}),F.isMobile||F.$lightbox.css({height:F.contentHeight+F.paddingVertical,width:F.contentWidth+F.paddingHorizontal,top:F.fixed?0:t.top});var i=F.oldContentHeight!==F.contentHeight||F.oldContentWidth!==F.contentWidth;(F.isMobile||!i)&&F.$lightbox.fsTransition("resolve"),F.oldContentHeight=F.contentHeight,F.oldContentWidth=F.contentWidth,F.isMobile&&D.addClass(E.lock)}function c(){if(F.visible&&!F.isMobile){var t=m();F.$controls.css({marginTop:(F.contentHeight-F.controlHeight-F.metaHeight)/2}),F.$lightbox.css({height:F.contentHeight+F.paddingVertical,width:F.contentWidth+F.paddingHorizontal,top:F.fixed?0:t.top})}}function p(){var t=m();F.$lightbox.css({top:F.fixed?0:t.top})}function m(){if(F.isMobile)return{left:0,top:0};var t={left:(i.windowWidth-F.contentWidth-F.paddingHorizontal)/2,top:F.top<=0?(i.windowHeight-F.contentHeight-F.paddingVertical)/2:F.top};return F.fixed!==!0&&(t.top+=K.scrollTop()),t}function u(t){B.killEvent(t),F.captionOpen?w():(F.$lightbox.addClass(q.raw.caption_open).find(q.caption_toggle).text(F.labels.captionOpen),F.captionOpen=!0)}function w(){F.$lightbox.removeClass(q.raw.caption_open).find(q.caption_toggle).text(F.labels.captionClosed),F.captionOpen=!1}function H(){var t=this.attr("title"),i=t!==e&&t?t.replace(/^\s+|\s+$/g,""):!1;return i?'<p class="caption">'+i+"</p>":""}function v(i){F.$image=t("<img>"),F.$image.one(A.load,function(){var t=k(F.$image);F.naturalHeight=t.naturalHeight,F.naturalWidth=t.naturalWidth,F.retina&&(F.naturalHeight/=2,F.naturalWidth/=2),F.$content.prepend(F.$image),""===F.$caption.html()?(F.$caption.hide(),F.$lightbox.removeClass(E.has_caption)):(F.$caption.show(),F.$lightbox.addClass(E.has_caption)),f(),h()}).error(j).attr("src",i).addClass(q.raw.image),(F.$image[0].complete||4===F.$image[0].readyState)&&F.$image.trigger(A.load)}function f(){var t=0;for(F.windowHeight=F.viewportHeight=i.windowHeight-F.mobilePaddingVertical-F.paddingVertical,F.windowWidth=F.viewportWidth=i.windowWidth-F.mobilePaddingHorizontal-F.paddingHorizontal,F.contentHeight=1/0,F.contentWidth=1/0,F.imageMarginTop=0,F.imageMarginLeft=0;F.contentHeight>F.viewportHeight&&2>t;)F.imageHeight=0===t?F.naturalHeight:F.$image.outerHeight(),F.imageWidth=0===t?F.naturalWidth:F.$image.outerWidth(),F.metaHeight=0===t?0:F.metaHeight,F.spacerHeight=0===t?0:F.spacerHeight,0===t&&(F.ratioHorizontal=F.imageHeight/F.imageWidth,F.ratioVertical=F.imageWidth/F.imageHeight,F.isWide=F.imageWidth>F.imageHeight),F.imageHeight<F.minHeight&&(F.minHeight=F.imageHeight),F.imageWidth<F.minWidth&&(F.minWidth=F.imageWidth),F.isMobile?(F.isTouch?(F.$controlBox.css({width:i.windowWidth}),F.spacerHeight=F.$controls.outerHeight(!0)):(F.$tools.css({width:i.windowWidth}),F.spacerHeight=F.$tools.outerHeight(!0)),F.contentHeight=F.viewportHeight,F.contentWidth=F.viewportWidth,b(),F.imageMarginTop=(F.contentHeight-F.targetImageHeight-F.spacerHeight)/2,F.imageMarginLeft=(F.contentWidth-F.targetImageWidth)/2):(0===t&&(F.viewportHeight-=F.margin+F.paddingVertical,F.viewportWidth-=F.margin+F.paddingHorizontal),F.viewportHeight-=F.metaHeight,b(),F.contentHeight=F.targetImageHeight,F.contentWidth=F.targetImageWidth),F.isMobile||F.isTouch||F.$meta.css({width:F.contentWidth}),F.$image.css({height:F.targetImageHeight,width:F.targetImageWidth,marginTop:F.imageMarginTop,marginLeft:F.imageMarginLeft}),F.isMobile||(F.metaHeight=F.$meta.outerHeight(!0),F.contentHeight+=F.metaHeight),t++}function b(){var t=F.isMobile?F.contentHeight-F.spacerHeight:F.viewportHeight,i=F.isMobile?F.contentWidth:F.viewportWidth;F.isWide?(F.targetImageWidth=i,F.targetImageHeight=F.targetImageWidth*F.ratioHorizontal,F.targetImageHeight>t&&(F.targetImageHeight=t,F.targetImageWidth=F.targetImageHeight*F.ratioVertical)):(F.targetImageHeight=t,F.targetImageWidth=F.targetImageHeight*F.ratioVertical,F.targetImageWidth>i&&(F.targetImageWidth=i,F.targetImageHeight=F.targetImageWidth*F.ratioHorizontal)),(F.targetImageWidth>F.imageWidth||F.targetImageHeight>F.imageHeight)&&(F.targetImageHeight=F.imageHeight,F.targetImageWidth=F.imageWidth),(F.targetImageWidth<F.minWidth||F.targetImageHeight<F.minHeight)&&(F.targetImageWidth<F.minWidth?(F.targetImageWidth=F.minWidth,F.targetImageHeight=F.targetImageWidth*F.ratioHorizontal):(F.targetImageHeight=F.minHeight,F.targetImageWidth=F.targetImageHeight*F.ratioVertical))}function $(i){var e=i.match(/(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/ ]{11})/i),o=i.match(/(?:www\.|player\.)?vimeo.com\/(?:channels\/(?:\w+\/)?|groups\/([^\/]*)\/videos\/|album\/(\d+)\/video\/|video\/|)(\d+)(?:$|\/|\?)/),a=i.split("?"),n=null!==e?"//www.youtube.com/embed/"+e[1]:"//player.vimeo.com/video/"+o[3];a.length>=2&&(n+="?"+a.slice(1)[0].trim()),F.$videoWrapper=t('<div class="'+q.raw.videoWrapper+'"></div>'),F.$video=t('<iframe class="'+q.raw.video+'" seamless="seamless"></iframe>'),F.$video.attr("src",n).addClass(q.raw.video).prependTo(F.$videoWrapper),F.$content.prepend(F.$videoWrapper),W(),h()}function W(){F.windowHeight=F.viewportHeight=i.windowHeight-F.mobilePaddingVertical-F.paddingVertical,F.windowWidth=F.viewportWidth=i.windowWidth-F.mobilePaddingHorizontal-F.paddingHorizontal,F.videoMarginTop=0,F.videoMarginLeft=0,F.isMobile?(F.isTouch?(F.$controlBox.css({width:i.windowWidth}),F.spacerHeight=F.$controls.outerHeight(!0)):(F.$tools.css({width:i.windowWidth}),F.spacerHeight=F.$tools.outerHeight(!0)),F.viewportHeight-=F.spacerHeight,F.targetVideoWidth=F.viewportWidth,F.targetVideoHeight=F.targetVideoWidth*F.videoRatio,F.targetVideoHeight>F.viewportHeight&&(F.targetVideoHeight=F.viewportHeight,F.targetVideoWidth=F.targetVideoHeight/F.videoRatio),F.videoMarginTop=(F.viewportHeight-F.targetVideoHeight)/2,F.videoMarginLeft=(F.viewportWidth-F.targetVideoWidth)/2):(F.viewportHeight=F.windowHeight-F.margin,F.viewportWidth=F.windowWidth-F.margin,F.targetVideoWidth=F.videoWidth>F.viewportWidth?F.viewportWidth:F.videoWidth,F.targetVideoWidth<F.minWidth&&(F.targetVideoWidth=F.minWidth),F.targetVideoHeight=F.targetVideoWidth*F.videoRatio,F.contentHeight=F.targetVideoHeight,F.contentWidth=F.targetVideoWidth),F.isMobile||F.isTouch||F.$meta.css({width:F.contentWidth}),F.$videoWrapper.css({height:F.targetVideoHeight,width:F.targetVideoWidth,marginTop:F.videoMarginTop,marginLeft:F.videoMarginLeft}),F.isMobile||(F.metaHeight=F.$meta.outerHeight(!0),F.contentHeight=F.targetVideoHeight+F.metaHeight)}function y(i){var e="";F.gallery.index>0&&(e=F.gallery.$items.eq(F.gallery.index-1).attr("href"),L(e)||t('<img src="'+e+'">')),F.gallery.index<F.gallery.total&&(e=F.gallery.$items.eq(F.gallery.index+1).attr("href"),L(e)||t('<img src="'+e+'">'))}function x(i){B.killEvent(i);var e=t(i.currentTarget);F.isAnimating||e.hasClass(q.raw.control_disabled)||(F.isAnimating=!0,w(),F.gallery.index+=e.hasClass(q.raw.control_next)?1:-1,F.gallery.index>F.gallery.total&&(F.gallery.index=F.infinite?0:F.gallery.total),F.gallery.index<0&&(F.gallery.index=F.infinite?F.gallery.total:0),F.$lightbox.addClass(q.raw.animating),F.$container.fsTransition({property:"opacity"},function(){"undefined"!=typeof F.$image&&F.$image.remove(),"undefined"!=typeof F.$videoWrapper&&F.$videoWrapper.remove(),F.$el=F.gallery.$items.eq(F.gallery.index),F.$caption.html(F.formatter.call(F.$el,F)),F.$position.find(q.position_current).html(F.gallery.index+1);var t=F.$el.attr("href"),i=L(t);i?$(t):v(t),C()}),F.$lightbox.addClass(q.raw.loading))}function C(){F.$controls.removeClass(q.raw.control_disabled),F.infinite||(0===F.gallery.index&&F.$controls.filter(q.control_previous).addClass(E.control_disabled),F.gallery.index===F.gallery.total&&F.$controls.filter(q.control_next).addClass(E.control_disabled))}function I(t){!F.gallery.active||37!==t.keyCode&&39!==t.keyCode?27===t.keyCode&&F.$close.trigger(A.click):(B.killEvent(t),F.$controls.filter(37===t.keyCode?q.control_previous:q.control_next).trigger(A.click))}function M(i){var e=t(i).find("> :first-child").clone();V(e)}function _(i){i+=i.indexOf("?")>-1?"&"+F.requestKey+"=true":"?"+F.requestKey+"=true";var e=t('<iframe class="'+q.raw.iframe+'" src="'+i+'"></iframe>');V(e)}function V(t){F.$content.append(t),T(t),h()}function T(t){F.windowHeight=i.windowHeight-F.mobilePaddingVertical-F.paddingVertical,F.windowWidth=i.windowWidth-F.mobilePaddingHorizontal-F.paddingHorizontal,F.objectHeight=t.outerHeight(!0),F.objectWidth=t.outerWidth(!0),F.targetHeight=F.targetHeight||(F.$el?F.$el.data(P+"-height"):null),F.targetWidth=F.targetWidth||(F.$el?F.$el.data(P+"-width"):null),F.maxHeight=F.windowHeight<0?F.minHeight:F.windowHeight,F.isIframe=t.is("iframe"),F.objectMarginTop=0,F.objectMarginLeft=0,F.isMobile||(F.windowHeight-=F.margin,F.windowWidth-=F.margin),F.contentHeight=F.targetHeight?F.targetHeight:F.isIframe||F.isMobile?F.windowHeight:F.objectHeight,F.contentWidth=F.targetWidth?F.targetWidth:F.isIframe||F.isMobile?F.windowWidth:F.objectWidth,(F.isIframe||F.isObject)&&F.isMobile?(F.contentHeight=F.windowHeight,F.contentWidth=F.windowWidth):F.isObject&&(F.contentHeight=F.contentHeight>F.windowHeight?F.windowHeight:F.contentHeight,F.contentWidth=F.contentWidth>F.windowWidth?F.windowWidth:F.contentWidth)}function j(i){var e=t('<div class="'+q.raw.error+'"><p>Error Loading Resource</p></div>');F.type="element",F.$tools.remove(),F.$image.off(A.namespace),V(e)}function z(t){F.captionOpen||F.$controls.filter("left"===t.directionX?q.control_next:q.control_previous).trigger(A.click)}function k(t){var i=t[0],e=new Image;return"undefined"!=typeof i.naturalHeight?{naturalHeight:i.naturalHeight,naturalWidth:i.naturalWidth}:"img"===i.tagName.toLowerCase()?(e.src=i.src,{naturalHeight:e.height,naturalWidth:e.width}):!1}function L(t){return t.indexOf("youtube.com")>-1||t.indexOf("youtu.be")>-1||t.indexOf("vimeo.com")>-1}var O=i.Plugin("lightbox",{widget:!0,defaults:{customClass:"",extensions:["jpg","sjpg","jpeg","png","gif"],fixed:!1,formatter:H,infinite:!1,labels:{close:"Close",count:"of",next:"Next",previous:"Previous",captionClosed:"View Caption",captionOpen:"Close Caption"},margin:50,minHeight:100,minWidth:100,mobile:!1,retina:!1,requestKey:"fs-lightbox",top:0,videoRatio:.5625,videoWidth:800},classes:["loading","animating","fixed","mobile","touch","inline","iframed","open","overlay","close","loading_icon","container","content","image","video","video_wrapper","tools","meta","controls","control","control_previous","control_next","control_disabled","position","position_current","position_total","caption_toggle","caption","caption_open","has_controls","has_caption","iframe","error","lock"],events:{open:"open",close:"close",swipe:"swipe"},methods:{_setup:o,_construct:n,_destruct:r,_resize:a,resize:d},utilities:{_initialize:l,close:s}}),P=O.namespace,R=O.defaults,q=O.classes,E=q.raw,A=O.events,B=O.functions,S=i.window,K=i.$window,N=null,D=null,F=null}(jQuery,Formstone);